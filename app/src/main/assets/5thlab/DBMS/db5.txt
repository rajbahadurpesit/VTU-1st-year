
DROP DATABASE EX5;
CREATE DATABASE EX5;
USE EX5;
CREATE TABLE BRANCH(BNAME VARCHAR(20) PRIMARY KEY,BCITY VARCHAR(20),ASSETS FLOAT(11));

CREATE TABLE ACCOUNT(ACCNO INT(11) PRIMARY KEY,BNAME VARCHAR(11),BALANCE FLOAT , FOREIGN KEY(BNAME) REFERENCES BRANCH(BNAME) ON DELETE CASCADE);

CREATE TABLE CUSTOMER(CNAME VARCHAR(11) PRIMARY KEY,CSTREET VARCHAR(11),CCITY VARCHAR(11));

CREATE TABLE DEPOSITOR(CNAME VARCHAR(11), ACCNO INT(11) , PRIMARY KEY(CNAME,ACCNO) ,FOREIGN KEY(CNAME) REFERENCES CUSTOMER(CNAME) ON DELETE CASCADE, FOREIGN KEY(ACCNO) REFERENCES ACCOUNT(ACCNO) ON DELETE CASCADE);

CREATE TABLE LOAN(LOANNO INT(11) PRIMARY KEY,BNAME VARCHAR(11) , AMOUNT FLOAT, FOREIGN KdasdsadasdEY(BNAME) REFERENCES BRANCH(BNAME) ON DELETE CASCADE);

CREATE TABLE BORROWER(CNAME VARCHAR(11), LOANNO INT(11),PRIMARY KEY(CNAME,LOANNO) , FOREIGN KEY(LOANNO) REFERENCES LOAN(LOANNO) ON DELETE CASCADE , FOREIGN KEY(CNAME) REFERENCES CUSTOMER(CNAME) ON DELETE CASCADE);

1
INSERT INTO BRANCH VALUES("PESSE","BANGALORE",50000);

INSERT INTO BRANCH VALUES("JPNAGAR","BANGALORE",51000);

INSERT INTO ACCOUNT VALUES(1014,'PESSE',20000);

INSERT INTO ACCOUNT VALUES(1015,'JPNAGAR',21000);

INSERT INTO ACCOUNT VALUES(1016,'PESSE',20000);

INSERT INTO ACCOUNT VALUES(1017,'JPNAGAR',20000);

INSERT INTO CUSTOMER VALUES("AJITH","3RD STREET","BANGALORE");

INSERT INTO CUSTOMER VALUES("JUJARE","4TH STREET","BANGALORE");

INSERT INTO DEPOSITOR VALUES("AJITH",1014);

INSERT INTO DEPOSITOR VALUES("AJITH",1016);

INSERT INTO DEPOSITOR VALUES("AJITH",1015);

INSERT INTO DEPOSITOR VALUES("JUJARE",1017);


SELECT D.CNAME FROM DEPOSITOR D,ACCOUNT A WHERE A.BNAME='PESSE' AND A.ACCNO=D.ACCNO GROUP BY D.CNAME HAVING COUNT(*)>=2;



2.
INSERT INTO BRANCH VALUES("PESSE","BANGALORE",50000);

INSERT INTO BRANCH VALUES("JPNAGAR","BANGALORE",51000);

SELECT D.CNAME FROM ACCOUNT A,DEPOSITOR D,BRANCH B WHERE D.ACCNO=A.ACCNO AND A.BNAME=B.BNAME AND B.BCITY='BANGALORE' GROUP BY D.CNAME HAVING COUNT(DISTINCT B.BNAME)=(SELECT COUNT(DISTINCT B.BNAME) FROM BRANCH B WHERE B.BCITY='BANGALORE');


3.
DELETE FROM ACCOUNT WHERE BNAME IN (SELECT B.BNAME FROM BRANCH B WHERE B.BCITY='BANGALORE');